(function(e){function t(t){for(var i,c,o=t[0],d=t[1],s=t[2],f=0,l=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&l.push(a[c][0]),a[c]=0;for(i in d)Object.prototype.hasOwnProperty.call(d,i)&&(e[i]=d[i]);p&&p(t);while(l.length)l.shift()();return r.push.apply(r,s||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,o=1;o<n.length;o++){var d=n[o];0!==a[d]&&(i=!1)}i&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},a={app:0},r=[];function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var p=d;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("6868")},"3abb":function(e,t,n){"use strict";var i=n("58e1"),a=n.n(i);a.a},4190:function(e,t,n){},"4bb1":function(e,t,n){"use strict";var i=n("a855"),a=n.n(i);a.a},"58e1":function(e,t,n){},"58ff":function(e,t,n){"use strict";var i=n("c08a"),a=n.n(i);a.a},a855:function(e,t,n){},bcd5:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Map"),n("HUD")],1)},a=[],r=(n("9eec"),n("04ca"),n("fc30"),n("4dc8"),n("8dcc"),n("aa12"),n("4809"),n("e821")),c=n("bd56"),o=n("3777"),d=n("2f62");function s(e){var t=[];e.map.forEach((function(n){(n.safe||n.flipped)&&[[n.x,n.y-1],[n.x,n.y+1],[n.x-1,n.y],[n.x+1,n.y]].forEach((function(n,i){f(n[0],n[1],e.map)||p(n[0],n[1],i,e)&&t.push(n)}))})),t.length&&s(e)}function p(e,t,n,i){if(i.deck.length){var a=i.deck.pop();if(a)return a.x=e,a.y=t,i.map.push(a),!0}return!1}function f(e,t,n){var i=null;return n.forEach((function(n){e===n.x&&t===n.y&&(i=n)})),i}o["a"].use(d["a"]);var l={name:"Entrance",id:"entrance",safe:!0,x:0,y:0,flipped:!1},u={name:"Descend",id:"descend",safe:!0,flipped:!1,x:1,y:0},m={name:"Dragon",id:"dragon",strength:6,type:"boss",flipped:!1,safe:!1,x:0,y:0},h=new d["a"].Store({state:{die:0,floor:1,forceHUD:!1,requiredStrength:0,engaged:null,shopping:!1,map:[l],deckSize:45,deck:[u,m].concat(Object(c["a"])(v("Rat",7,{safe:!1,strength:3})),Object(c["a"])(v("Spider",7,{safe:!1,strength:4})),Object(c["a"])(v("Snake",7,{safe:!1,strength:5})),Object(c["a"])(v("Shop",2,{safe:!0})),Object(c["a"])(v("Wall",12,{safe:!1})),[{name:"Sword",id:"sword",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Staff",id:"staff",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Bow",id:"bow",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Helm",id:"helm",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Gauntlets",id:"gauntlets",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Armor",id:"armor",safe:!0,flipped:!1,type:"item",x:0,y:0},{name:"Coin",id:"coin",safe:!0,flipped:!1,type:"item",x:0,y:0}]),inv:{sword:{name:"Sword",type:"weapon",inv:!0,flipped:!1,discarded:!1},staff:{name:"Staff",type:"weapon",inv:!0,flipped:!0,discarded:!1},bow:{name:"Bow",type:"weapon",inv:!0,flipped:!0,discarded:!1},armor:{name:"Armor",type:"armor",inv:!0,flipped:!1,discarded:!1},gauntlets:{name:"Gauntlets",type:"armor",inv:!0,flipped:!0,discarded:!1},helm:{name:"Helm",type:"armor",inv:!0,flipped:!0,discarded:!1},coin:{name:"Coin",inv:!0,flipped:!0},key:{name:"Key",inv:!0,flipped:!0}}},mutations:{shuffle:function(e){for(var t=e.deck.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),i=[e.deck[n],e.deck[t]];e.deck[t]=i[0],e.deck[n]=i[1]}},explore:function(e){s(e)},setStrength:function(e,t){e.requiredStrength=t.strength},forceHUD:function(e){e.forceHUD=!0},releaseHUD:function(e){e.forceHUD=!1},startShopping:function(e){e.shopping=!0},stopShopping:function(e){e.shopping=!1},engage:function(e,t){e.engaged=t.card},flip:function(e,t){t.card.flipped=!t.card.flipped},roll:function(e){e.die=Math.floor(6*Math.random())+1},increaseDie:function(e){e.die+=1},discard:function(e,t){t.card.discarded=!0}},actions:{descend:function(e){var t=e.commit,n=e.state;n.inv.key.flipped=!0,n.map=n.map.filter((function(e){return"Entrance"!==e.name&&"Descend"!==e.name&&"boss"!==e.type})),n.deck=n.deck.filter((function(e){return"Entrance"!==e.name&&"Descend"!==e.name&&"boss"!==e.type})),n.deck=[].concat(Object(c["a"])(n.deck),Object(c["a"])(n.map)),t("shuffle"),n.deck=[].concat(Object(c["a"])(n.deck.splice(7)),[m,u]),t("shuffle"),n.deck.forEach((function(e){e.x=0,e.y=0,e.flipped=!1})),n.map=[l],n.deckSize=n.deck.length+1,n.floor+=1,t("explore")}}});function v(e,t,n){for(var i=[],a=1;a<=t;a++)i.push(Object(r["a"])({name:e,flipped:!1,id:"".concat(e,"-").concat(a),safe:!1,x:0,y:0},n));return i}var g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map"},[n("div",{staticClass:"map-inner"},e._l(e.map,(function(t){return n("Card",{key:t.id,attrs:{card:t},on:{click:e.click}})})),1)])},y=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card",class:{flipped:e.flipped,safe:e.safe,inv:e.inv,engaged:e.engaged,boss:e.boss,descend:e.descend},style:e.style,on:{click:function(t){return e.$emit("click",t,e.card)}}},[n("div",{staticClass:"card-front"},[e._v(" "+e._s(e.card.name)+" "),e.card.strength?n("div",{staticClass:"strength"},[e._v(" "+e._s(e.card.strength)+" ")]):e._e()]),n("div",{staticClass:"card-back"},[e.card.inv?n("span",[e._v(" "+e._s(e.card.name)+" ")]):e._e()])])},k=[];function w(e,t){var n=window.map.width/2,i=window.map.height/2,a=70,r=94,c=5;return{x:n+e*(a+c),y:i+t*(r+c)}}var x=w,_={props:["card"],computed:{flipped:function(){return this.card.flipped},safe:function(){return this.card.safe},inv:function(){return this.card.inv},boss:function(){return"boss"===this.card.type},descend:function(){return"descend"===this.card.id},engaged:function(){return!!h.state.engaged&&this.card.id===h.state.engaged.id},style:function(){if(void 0!==this.card.x&&void 0!==this.card.y){var e=x(this.card.x,this.card.y),t={left:"".concat(e.x,"px"),top:"".concat(e.y,"px")};return t}return{}}}},S=_,C=(n("3abb"),n("95c6")),D=Object(C["a"])(S,b,k,!1,null,"241e2eb4",null),O=D.exports;window.map={width:5e3,height:5e3};var j={components:{Card:O},mounted:function(){var e=document.querySelector(".map-inner");e.style.width=window.map.width+"px",e.style.height=window.map.height+"px",document.querySelector(".map").scrollTo(window.map.width/2-window.innerWidth/2,window.map.height/2-window.innerHeight/2)},computed:{map:function(){return h.state.map}},methods:{click:function(e,t){if(t.flipped)return!1;if(h.state.engaged&&h.state.engaged.id===t.id)return!1;var n=t.strength;if(n)h.commit("roll"),h.state.die>=n?(h.commit({type:"flip",card:t}),h.commit("explore"),"boss"===t.type&&h.commit("flip",{card:h.state.inv.key})):(h.commit({type:"setStrength",strength:n}),h.commit("forceHUD"),h.commit({type:"engage",card:t}));else if("item"===t.type){var i=h.state.inv[t.id];i&&i.flipped&&(h.commit({type:"flip",card:t}),h.commit({type:"flip",card:i}))}else if("Wall"===t.name){h.commit({type:"flip",card:t}),h.commit("explore");var a=Math.floor(6*Math.random())+1,r=["sword","staff","bow","armor","helm","gauntlets"],c=r[a-1];h.state.inv[c].flipped?h.commit({type:"discard",card:h.state.inv[c]}):h.commit({type:"flip",card:h.state.inv[c]})}else"Shop"===t.name?h.state.inv.coin.flipped||(h.commit({type:"flip",card:h.state.inv.coin}),h.commit("forceHUD"),h.commit("startShopping")):"descend"!==t.id||h.state.inv.key.flipped||h.dispatch("descend")}}},H=j,U=(n("58ff"),Object(C["a"])(H,g,y,!1,null,"29d2affa",null)),M=U.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"HUD"},[e.die?n("div",{staticClass:"die"},[e._v(e._s(e.die))]):e._e(),n("div",{staticClass:"remaining"},[n("span",[e._v(e._s(e.remaining)+" / "+e._s(e.total))]),n("span",{staticClass:"floor"},[e._v("Floor "+e._s(e.floor))])]),n("div",{staticClass:"cards",class:{force:e.forceHUD}},[n("div",{staticClass:"group left"},[e.inv.sword.discarded?e._e():n("Card",{attrs:{card:e.inv.sword},on:{click:e.click}}),e.inv.staff.discarded?e._e():n("Card",{attrs:{card:e.inv.staff},on:{click:e.click}}),e.inv.bow.discarded?e._e():n("Card",{attrs:{card:e.inv.bow},on:{click:e.click}})],1),n("div",{staticClass:"group middle"},[e.inv.armor.discarded?e._e():n("Card",{attrs:{card:e.inv.armor},on:{click:e.click}}),e.inv.helm.discarded?e._e():n("Card",{attrs:{card:e.inv.helm},on:{click:e.click}}),e.inv.gauntlets.discarded?e._e():n("Card",{attrs:{card:e.inv.gauntlets},on:{click:e.click}})],1),n("div",{staticClass:"group right"},[n("Card",{attrs:{card:e.inv.coin},on:{click:e.click}}),n("Card",{attrs:{card:e.inv.key},on:{click:e.click}})],1)])])},q=[],P={components:{Card:O},methods:{click:function(e,t){h.state.shopping?t.flipped&&"Key"!==t.name&&(h.commit({type:"flip",card:t}),h.commit("stopShopping"),h.commit("releaseHUD")):h.state.forceHUD&&(t.flipped?"Coin"!==t.name&&"Key"!==t.name&&(h.commit({type:"discard",card:t}),h.commit("releaseHUD"),h.commit("engage",{card:null}),h.commit({type:"setStrength",requiredStrength:0})):(h.commit({type:"flip",card:t}),"armor"===t.type?(h.commit("releaseHUD"),h.commit("engage",{card:null}),h.commit({type:"setStrength",requiredStrength:0})):"weapon"===t.type&&(h.commit("increaseDie"),h.state.die>=h.state.requiredStrength&&(h.commit({type:"setStrength",requiredStrength:0}),h.commit({type:"flip",card:h.state.engaged}),h.commit("releaseHUD"),h.commit("explore"),"boss"===h.state.engaged.type&&h.commit("flip",{card:h.state.inv.key}),h.commit("engage",{card:null})))))}},computed:{inv:function(){return h.state.inv},strength:function(){return h.state.requiredStrength},floor:function(){return h.state.floor},remaining:function(){return h.state.deck.length},total:function(){return h.state.deckSize},forceHUD:function(){return h.state.forceHUD},die:function(){return h.state.die}}},$=P,z=(n("4bb1"),Object(C["a"])($,E,q,!1,null,"3a12e58e",null)),K=z.exports;h.commit("shuffle"),h.commit("explore");var T={components:{Map:M,HUD:K}},W=T,A=(n("e5cd"),Object(C["a"])(W,i,a,!1,null,null,null));t["a"]=A.exports},c08a:function(e,t,n){},e5cd:function(e,t,n){"use strict";var i=n("4190"),a=n.n(i);a.a}});
//# sourceMappingURL=app.cac97451.js.map